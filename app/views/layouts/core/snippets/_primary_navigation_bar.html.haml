-# The button and fake banner for enabling our responsive navigation
- unless homepage
  .row--faux-banner
%input{type: "checkbox", id: 'nav--primary__trigger', class: "is-hidden"}
%label{for: 'nav--primary__trigger', class: 'nav--primary__trigger'}


%a.media--lp-logo.logo--header(href='http://www.lonelyplanet.com')

.nav-container.m-hidden-menu

  .wv--split--right

    .wv--nav--inline.split--right__inner.nav--user

      -# This form is only visible on wide screens, and not on the homepage
      - unless homepage
        %form.search--primary.search--primary-wv.js-nav-search.wv--inline-block{:action => host_with_subdomain_and_path("www", "searchResult"), :method => "get" }
          %label.accessibility(for='search-q') Search
          %input.search__input.search__input--primary.js-primary-search(type="search" id="search" maxlength="2048" name="q" value="" autocomplete="off" tabindex="1")>
          %button(class="search__button" type="submit" id="search-q-submit" name="search-q-submit")
            %span.search__button--icon
              Search

      - if user_nav
        .nav__item.wv--nav--inline.nav--primary--user.js-user-nav.split--right__inner
          %a.nav__item.nav__item--primary.nav__item--user.user-basket.js-user-basket.js-nav-cart(href='//shop.lonelyplanet.com/cart/view')
            %span.user-basket__icon
              View Basket


  .wv--split--left
    
    .wv--nav--inline.nav--primary

      - core_navigation_items.each do |n|
        - if n[:submenu]
          .nav__item.nav__item--primary.nav__submenu__trigger
            - if n[:uri]
              %a.nav__item.nav__item--submenu.js-nav-item{ href: n[:uri] }
                = n[:title]
            - else
              %span.nav__item.nav__item--submenu
                = n[:title]
            .nav__submenu{ class: "nav__submenu--#{n[:title].downcase}"}
              .nav--stacked.nav__submenu__content.js-submenu
                - n[:submenu].each do |sub|
                  %a.js-nav-item{ href: sub[:uri], class: "nav__item nav__submenu__item nav__submenu__link nav__submenu__item--#{sub[:style]}"}<
                    = sub[:title]
        - else
          %a.nav__item.nav__item--primary{ href: n[:uri] }<
            = n[:title]
